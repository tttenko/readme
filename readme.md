```java
Это по сути “универсальный обработчик” Kafka-сообщений с XML: он берёт запись, достаёт routeKey, по нему находит нужный маршрут в RoutesRegistry, чистит BOM, парсит XML в нужный DTO и вызывает правильный consumer.

Плюс в том, что вся повторяющаяся обвязка (выбор обработчика, парсинг, типизация, единый формат ошибок) живёт в одном месте. В listener’ах и сервисах не появляется огромный switch/if и копипаста — чтобы добавить новый тип сообщения, достаточно зарегистрировать новый маршрут/DTO, а пайплайн остаётся прежним.
```
