```java

/**
 * Сервис получения базовых ставок НДС с кэшированием по «ставке» (rate).
 * <p>
 * Алгоритм:
 * <ol>
 *   <li>Определяет целевую дату (если {@code date == null} — берётся {@link ZonedDateTime#now()}).</li>
 *   <li>Формирует список ключей бакетов: заданные {@code rate} либо специальный {@code "__ALL__"}.</li>
 *   <li>Через {@link BatchCacheSupport} достаёт из кэша готовые бакеты и вычисляет «промахи».</li>
 *   <li>Для промахов запрашивает все записи из МД на дату, группирует по ставке и кладёт в кэш.</li>
 *   <li>Сшивает содержимое бакетов, применяет фильтры (по дате/ставке/коду) и маппит в DTO.</li>
 * </ol>
 *
 * <h3>Кэш</h3>
 * Используется именованный кэш {@link #CACHE_NDS_BY_RATE}. Ключом выступает строка «ставка»,
 * либо {@link #ALL_KEY} — бакет, содержащий объединение всех записей.
 *
 * @implNote Сервис stateless, потокобезопасен при условии потокобезопасного {@code CacheManager}.
 * @since 1.0
 */

```
