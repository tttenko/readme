/**
 * Базовый класс для интеграционных тестов кэша.
 * Инкапсулирует общий доступ к CacheManager и абстракции управления временем.
 */
public abstract class AbstractTTLAndAllCleanCacheTest {

  /** Доступ к кэшам в тестах. */
  protected final CacheManager cacheManager;

  /** Возможность вызывать плановую очистку в тестах. */
  @Setter
  protected CacheEvictScheduler cacheEvictScheduler;

  /**
   * @param cacheManager менеджер кэшей, предоставляемый контекстом Spring
   */
  protected AbstractTTLAndAllCleanCacheTest(CacheManager cacheManager) {
    this.cacheManager = cacheManager;
  }

  /**
   * Продвинуть тестовое время на указанное число минут.
   * Реализация зависит от конкретного тикера/реализации кэша.
   *
   * @param minutes на сколько минут продвинуть время
   */
  protected abstract void advanceTime(long minutes);

  /**
   * @return ожидаемый TTL (в минутах), с которым настроен кэш в тесте
   */
  protected abstract long getConfiguredTTLMinutes();
}
